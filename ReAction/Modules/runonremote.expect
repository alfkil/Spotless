#!/usr/bin/expect
#log_user 0

set timeout 20

set name [lindex $argv 0]
set port [lindex $argv 1]
set password [lindex $argv 2]
set command [lindex $argv 3]

spawn telnet $name $port

#expect "login:" 
#send "$user "

expect "password:"
send "$password \n"


#for now, we need to set the execute flag
expect ">"
send "! protect $command +e\r"

expect ">"
send "! $command\r"
expect "! $command\r"
expect ">"

puts [open result.txt w] $expect_out(buffer)

send "quit"
expect "quit"
